# ì„¸ì…˜ê³¼ ì¿ í‚¤ ê¸°ë°˜ ì¸ì¦ íë¦„ ì´í•´

## âœ… ìƒíƒœ ìœ ì§€ ì „ëµ (Session vs Cookie)

ì›¹ì€ ê¸°ë³¸ì ìœ¼ë¡œ **ë¬´ìƒíƒœ(stateless)** í”„ë¡œí† ì½œì´ê¸° ë•Œë¬¸ì—, ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í–ˆëŠ”ì§€ ì•„ë‹Œì§€ë¥¼ ì„œë²„ê°€ "ê¸°ì–µ"í•˜ë ¤ë©´ ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” ì „ëµì´ í•„ìš”í•˜ë‹¤.

### ğŸ”’ 1. Session ê¸°ë°˜ ì¸ì¦

- **ì €ì¥ ìœ„ì¹˜**: ì„œë²„ ë©”ëª¨ë¦¬ / DB (ì„œë²„ ì¸¡)
- **ë™ì‘ íë¦„**:
  1. ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ë©´ ì„œë²„ì—ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ **ì„¸ì…˜ ID**ë¥¼ ìƒì„±
  2. ì´ ì„¸ì…˜ IDë¥¼ í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ì—ê²Œ **ì¿ í‚¤ í˜•íƒœë¡œ ì „ë‹¬**
  3. ì´í›„ ìš”ì²­ë§ˆë‹¤ ì´ ì„¸ì…˜ IDê°€ ì¿ í‚¤ë¡œ í•¨ê»˜ ì „ë‹¬ë¨
  4. ì„œë²„ëŠ” ì„¸ì…˜ IDë¥¼ ë³´ê³  ì €ì¥ëœ ìœ ì € ì •ë³´ì™€ ë§¤ì¹­í•´ì„œ ì¸ì¦ ìƒíƒœ í™•ì¸

- **ì¥ì **:
  - ë³´ì•ˆì„±ì´ ë†’ìŒ (ì¤‘ìš” ì •ë³´ê°€ ì„œë²„ì—ë§Œ ìˆìŒ)
  - í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°ì´í„° ì¡°ì‘ ì–´ë ¤ì›€

- **ë‹¨ì **:
  - ì„œë²„ ë¦¬ì†ŒìŠ¤ ì†Œëª¨ (ì‚¬ìš©ì ìˆ˜ ë§ì•„ì§€ë©´ ë©”ëª¨ë¦¬ ë¬¸ì œ)
  - ë¡œë“œ ë°¸ëŸ°ì‹± ì‹œ ì„¸ì…˜ ê³µìœ (Sticky session ë˜ëŠ” Redis ê°™ì€ external store í•„ìš”)

---

### ğŸª 2. Cookie ê¸°ë°˜ ì¸ì¦ (í† í° ë°©ì‹: JWT ë“±)

- **ì €ì¥ ìœ„ì¹˜**: í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ì˜ ì¿ í‚¤ ë˜ëŠ” ë¡œì»¬ìŠ¤í† ë¦¬ì§€
- **ë™ì‘ íë¦„**:
  1. ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ë©´ ì„œë²„ì—ì„œ **JWT í† í°**ì„ ìƒì„±
  2. ì´ í† í°ì„ ë¸Œë¼ìš°ì €ì˜ **ì¿ í‚¤ì— ì €ì¥í•˜ê±°ë‚˜** ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
  3. ì´í›„ ìš”ì²­ë§ˆë‹¤ ì´ í† í°ì„ **Authorization í—¤ë” ë˜ëŠ” ì¿ í‚¤ì— í¬í•¨ì‹œì¼œ** ì„œë²„ë¡œ ì „ì†¡
  4. ì„œë²„ëŠ” í† í°ì„ ê²€ì¦í•˜ê³ , ìœ ì € ì •ë³´ë¥¼ ì¶”ì¶œ

- **ì¥ì **:
  - ì„œë²„ ìƒíƒœì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ (Stateless)
  - í™•ì¥ì„± ì¢‹ìŒ (ì„œë²„ ì¦ì„¤ ì‰¬ì›€)
  - ëª¨ë°”ì¼ ì•± ë“± ë‹¤ì–‘í•œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥

- **ë‹¨ì **:
  - í† í° íƒˆì·¨ ìœ„í—˜ (XSS, CSRF ë“±)
  - í† í°ì´ ìœ ì¶œë˜ë©´ ìœ ì € ì •ë³´ë¥¼ ë³´í˜¸í•  ìˆ˜ ì—†ìŒ
  - í† í°ì´ í¬ë©´ ìš”ì²­ë§ˆë‹¤ ë¬´ê±°ì›€

---

## ğŸ” ë¡œê·¸ì¸ êµ¬ì¡° ì ìš© ì˜ˆì‹œ

### 1. Session ê¸°ë°˜ ë¡œê·¸ì¸ íë¦„ ì˜ˆì‹œ (ì„œë²„: Express.js ê¸°ì¤€)

\`\`\`ts
// ë¡œê·¸ì¸ ìš”ì²­
app.post('/login', (req, res) => {
  const { username, password } = req.body;
  const user = db.findUser(username);
  if (user && user.password === password) {
    req.session.userId = user.id; // ì„¸ì…˜ì— ì €ì¥
    res.send('Login successful');
  } else {
    res.status(401).send('Invalid credentials');
  }
});

// ì¸ì¦ í•„ìš”í•œ API
app.get('/dashboard', (req, res) => {
  if (req.session.userId) {
    res.send('Welcome!');
  } else {
    res.status(401).send('Not authenticated');
  }
});
\`\`\`

### 2. JWT ê¸°ë°˜ ë¡œê·¸ì¸ íë¦„ ì˜ˆì‹œ

\`\`\`ts
// ë¡œê·¸ì¸ ìš”ì²­
app.post('/login', (req, res) => {
  const { username, password } = req.body;
  const user = db.findUser(username);
  if (user && user.password === password) {
    const token = jwt.sign({ id: user.id }, 'secret_key', { expiresIn: '1h' });
    res.cookie('token', token); // ë˜ëŠ” ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê²Œ í•  ìˆ˜ë„ ìˆìŒ
    res.send('Login successful');
  } else {
    res.status(401).send('Invalid credentials');
  }
});

// ì¸ì¦ ë¯¸ë“¤ì›¨ì–´
function authMiddleware(req, res, next) {
  const token = req.cookies.token;
  if (!token) return res.status(401).send('No token');

  try {
    const decoded = jwt.verify(token, 'secret_key');
    req.user = decoded;
    next();
  } catch (err) {
    res.status(401).send('Invalid token');
  }
}
\`\`\`

---

## ğŸ”„ ì •ë¦¬ ìš”ì•½ ë¹„êµí‘œ

| í•­ëª© | ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ | ì¿ í‚¤(JWT) ê¸°ë°˜ ì¸ì¦ |
|------|----------------|----------------------|
| ì €ì¥ ìœ„ì¹˜ | ì„œë²„ | í´ë¼ì´ì–¸íŠ¸ |
| ìƒíƒœ ìœ ì§€ | ìœ  | ë¬´ (Stateless) |
| ë³´ì•ˆ | ìƒëŒ€ì ìœ¼ë¡œ ê°•í•¨ | í† í° íƒˆì·¨ ìœ„í—˜ ìˆìŒ |
| í™•ì¥ì„± | ë‚®ìŒ (ì„¸ì…˜ ê³µìœ  í•„ìš”) | ë†’ìŒ (ì„œë²„ í™•ì¥ ì‰¬ì›€) |
| ì‚¬ìš©ì„± | ì›¹ì—ì„œ ì£¼ë¡œ ì‚¬ìš© | ì›¹ + ëª¨ë°”ì¼ ë“± ë‹¤ì–‘ |

---

## ğŸ“Œ ê²°ë¡ 

- **ì†Œê·œëª¨ ì„œë¹„ìŠ¤**: ì„¸ì…˜ ê¸°ë°˜ì´ ê´€ë¦¬í•˜ê¸° ì‰¬ì›€
- **ëŒ€ê·œëª¨ ì„œë¹„ìŠ¤ / SPA / ëª¨ë°”ì¼ ì•±**: JWT ê¸°ë°˜ì´ í™•ì¥ì„±, ìœ ì—°ì„±ì—ì„œ ìœ ë¦¬
- **ë³´ì•ˆ**: ë‘˜ ë‹¤ HTTPS ì‚¬ìš©, í† í° ë§Œë£Œ, ì¬ë°œê¸‰ ì „ëµ, XSS/CSRF ë°©ì–´ í•„ìš”