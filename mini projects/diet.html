<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‚˜ì˜ ë‹¤ì´ì–´íŠ¸ ë„ìš°ë¯¸</title>
  <style>
    body {
      font-family: 'Arial';
      padding: 30px;
      background-color: #f7f7f7;
    }

    h1 {
      text-align: center;
      color: #2c3e50;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input, button {
      margin-top: 5px;
      padding: 8px;
      font-size: 14px;
      width: 200px;
    }

    button {
      cursor: pointer;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
    }

    #instruction {
      margin-top: 30px;
      font-size: 16px;
      font-weight: bold;
      color: #555;
    }

    #message {
      margin-top: 10px;
      font-size: 18px;
      font-weight: bold;
      color: green;
    }

    #dday {
      margin-top: 10px;
      font-size: 18px;
      font-weight: bold;
      color: #e67e22;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
      margin-top: 20px;
    }

    .day {
      background-color: white;
      border: 1px solid #ccc;
      padding: 10px;
      height: 70px;
      text-align: center;
      position: relative;
      cursor: pointer;
      border-radius: 10px;
    }

    .completed {
      background-color: #2ecc71;
      color: white;
      border-radius: 50%;
      font-weight: bold;
    }

    .failed {
      background-color: #e74c3c;
      color: white;
      font-weight: bold;
    }

    .failed::after {
      content: "âŒ";
      position: absolute;
      bottom: 5px;
      right: 5px;
      font-size: 18px;
    }

    .weight-note {
      display: block;
      font-size: 13px;
      color: #34495e;
      margin-top: 4px;
    }
  </style>
</head>
<body>

  <h1>ë‚˜ì˜ ë‹¤ì´ì–´íŠ¸ ë„ìš°ë¯¸</h1>

  <div>
    <label>ğŸ¯ ëª©í‘œ ëª¸ë¬´ê²Œ (kg):</label>
    <input type="number" id="goalWeight" placeholder="ì˜ˆ: 55">

    <label>ğŸ“… ì‹œì‘ ë‚ ì§œ:</label>
    <input type="date" id="startDate">

    <label>ğŸ ì¢…ë£Œ ë‚ ì§œ:</label>
    <input type="date" id="endDate">

    <br><br>
    <button onclick="generateCalendar()">ë‹¬ë ¥ ìƒì„±</button>
  </div>

  <div id="instruction">ğŸ’ª ìš´ë™ì„ ì™„ë£Œí•œ ë‚ ì˜ ë‚ ì§œë¥¼ í´ë¦­í•´ì£¼ì„¸ìš”!</div>
  <div id="dday">â³ D-Day: </div>
  <div id="message"></div>

  <div id="calendar" class="calendar"></div>

  <script>
    const weightData = {}; // ë‚ ì§œë³„ ëª¸ë¬´ê²Œ ì €ì¥

    function generateCalendar() {
      const calendar = document.getElementById("calendar");
      const messageBox = document.getElementById("message");
      const ddayBox = document.getElementById("dday");
      calendar.innerHTML = "";
      messageBox.innerText = "";
      ddayBox.innerText = "";

      const start = new Date(document.getElementById("startDate").value);
      const end = new Date(document.getElementById("endDate").value);
      const today = new Date();

      if (isNaN(start) || isNaN(end)) {
        alert("ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”!");
        return;
      }

      if (end < start) {
        alert("ì¢…ë£Œì¼ì€ ì‹œì‘ì¼ë³´ë‹¤ ë’¤ì—¬ì•¼ í•©ë‹ˆë‹¤.");
        return;
      }

      // âœ… D-Day ê³„ì‚°
      const daysLeft = Math.ceil((end - today) / (1000 * 60 * 60 * 24));
      if (daysLeft >= 0) {
        ddayBox.innerText = `â³ ëª©í‘œì¼ê¹Œì§€ D-${daysLeft}`;
      } else {
        ddayBox.innerText = `ğŸ ë‹¤ì´ì–´íŠ¸ ì¢…ë£Œ!`;
      }

      // ğŸ“… ë‹¬ë ¥ ìƒì„±
      for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
        const dateBox = document.createElement("div");
        dateBox.classList.add("day");

        const dateStr = d.toISOString().split('T')[0];
        dateBox.innerHTML = `<div>${dateStr}</div><span class="weight-note" id="weight-${dateStr}">-</span>`;

        const thisDate = new Date(d);

        // ğŸ“Œ í´ë¦­ ì´ë²¤íŠ¸: ìš´ë™ ì™„ë£Œ + ëª¸ë¬´ê²Œ ê¸°ë¡
        dateBox.addEventListener("click", () => {
          if (dateBox.classList.contains("failed")) return;

          // ëª¸ë¬´ê²Œ ì…ë ¥ ë°›ê¸°
          const weight = prompt(`${dateStr}ì˜ ëª¸ë¬´ê²Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (kg):`, weightData[dateStr] || "");
          if (weight) {
            weightData[dateStr] = weight;
            const note = document.getElementById(`weight-${dateStr}`);
            note.innerText = `${weight}kg`;
          }

          // ìš´ë™ ì™„ë£Œ í† ê¸€
          dateBox.classList.toggle("completed");

          if (dateBox.classList.contains("completed")) {
            messageBox.innerText = `${dateStr} âœ… ë¯¸ì…˜ ì™„ë£Œ!`;
          } else {
            messageBox.innerText = `${dateStr} âŒ ë¯¸ì…˜ ì·¨ì†Œë¨`;
          }
        });

        // âŒ ì‹¤íŒ¨ ìë™ í‘œì‹œ
        const now = new Date();
        if (thisDate < now.setHours(0, 0, 0, 0)) {
          const formattedToday = new Date().toISOString().split('T')[0];
          if (dateStr < formattedToday) {
            dateBox.classList.add("failed");
            dateBox.title = "ìš´ë™ ì•ˆ í•´ì„œ ì‹¤íŒ¨!";
          }
        }

        calendar.appendChild(dateBox);
      }
    }
  </script>
</body>
</html>
